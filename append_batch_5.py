import csv

# Batch 5: Questions 1-30 (Quant & Risk)
new_entries = [
    {
        "Question": "A portfolio manager holds a long position in a stock and wants to hedge using put options. If the stock has a delta of 0.75 and a gamma of 0.05, what is the approximate delta of a 1-month put option (assume European style)?",
        "Reasoning": "<reason>\nAccording to Put-Call Parity and standard option theory, the delta of a put option is related to the delta of a call option by the formula: Delta(Put) = Delta(Call) - 1. If we assume the 'stock having a delta of 0.75' refers to a Call option or a fractional hedge ratio, the Put delta would be 0.75 - 1 = -0.25.\n</reason>\n<exception>\nHowever, if the 'stock' refers to the underlying asset itself, its delta is always 1.0. The 0.75 figure likely refers to an existing Call option position the manager holds. If the manager holds the *actual stock* (Delta=1) and the question implies the *Put* has similar characteristics to a Call with Delta 0.75 (same strike/maturity), then the Put delta is roughly -0.25 (specifically N(d1)-1). Gamma is positive for long options, so it doesn't affect the instantaneous delta calculation but implies convexity.\n</exception>\n<tension>\nThis is a tension between 'Textbook Definitions' (Stock Delta = 1) and 'Market Convention/Phrasing' (Referring to a Call's delta as 'the delta').\n</tension>\n<categorization>\nThis is a 'Derivatives Pricing' and 'Risk Management' problem.\n</categorization>\n<deconstruction>\nThe question phrasing is ambiguous. Standard stock delta is 1. If 0.75 is the Call Delta at the money (ITM actually), then the Put Delta is Call Delta - 1 = -0.25. If the stock itself has a delta of 0.75, it must be a derivative or a beta-adjusted value.\n</deconstruction>\n<conclusion>\nAssuming the 0.75 refers to the corresponding Call option delta (ITM), the Put option delta is approximately -0.25. The gamma of 0.05 indicates that for every $1 move in the stock, the delta changes by 0.05.\n</conclusion>"
    },
    {
        "Question": "Explain the relationship between Value-at-Risk (VaR) and Conditional Value-at-Risk (CVaR). Under what market conditions would CVaR be significantly higher than VaR?",
        "Reasoning": "<reason>\nVaR is the maximum loss at a specific confidence level (e.g., 95%), while CVaR (Expected Shortfall) is the *average* loss *beyond* that VaR threshold. CVaR >= VaR by definition. They are close when the return distribution is Normal (Gaussian).\n</reason>\n<exception>\nCVaR becomes significantly higher than VaR when the return distribution has 'Fat Tails' (Leptokurtic). In a market crash or liquidity crisis, losses don't stop right at the VaR line; they can extend far beyond. VaR ignores the *magnitude* of the tail disaster; CVaR captures it.\n</exception>\n<tension>\nThis is a tension between 'Standard Risk Metrics' (VaR - easy to communicate) and 'Tail Risk Reality' (CVaR - harder to estimate but safer).\n</tension>\n<categorization>\nThis is a 'Financial Risk Management' dilemma.\n</categorization>\n<deconstruction>\nVaR is not 'Sub-additive', meaning the risk of a portfolio can be larger than the sum of its parts. CVaR is 'Coherent' and sub-additive. VaR encourages 'Tail Risk Stuffing' (taking risks that only blow up 1% of the time).\n</deconstruction>\n<conclusion>\nCVaR > VaR in 'Fat Tail' or 'Skewed' markets (e.g., Short Volatility strategies). Use CVaR for capital allocation to avoid catastrophic ruin that VaR blinds you to.\n</conclusion>"
    },
    {
        "Question": "A hedge fund calculates a rolling 20-day VaR at the 95% confidence level of $2M. What does this mean in terms of expected losses, and what are the limitations of using VaR for risk measurement?",
        "Reasoning": "<reason>\nIt means that in 95% of 20-day periods, the fund will not lose more than $2M. Conversely, there is a 5% chance (1 in 20 periods) that losses will *exceed* $2M.\n</reason>\n<exception>\nLimitation: It tells you nothing about *how much* you lose in that 5% worst-case scenario. You could lose $2.1M or $100M. VaR assumes historical correlations hold, which often break (correlation goes to 1) during crises.\n</exception>\n<tension>\nThis is a tension between 'Probabilistic Assurance' and 'Black Swan Events'. VaR gives a false sense of security.\n</tension>\n<categorization>\nThis is a 'Quantitative Risk Analysis' problem.\n</categorization>\n<deconstruction>\nVaR is often based on Normal distributions. Markets are not Normal. It underestimates the frequency of 3-sigma events. It is a 'rear-view mirror' metric.\n</deconstruction>\n<conclusion>\nInterpret $2M as the 'minimum' loss on a bad day, not the maximum. Supplement VaR with Stress Tests (Scenario Analysis) to understand the true downside.\n</conclusion>"
    },
    {
        "Question": "How would you construct a minimum variance portfolio using 50 assets with incomplete correlation matrix data? What imputation methods would you consider?",
        "Reasoning": "<reason>\nStandard Mean-Variance Optimization requires a full covariance matrix. With missing data, you must impute values. Common methods include 'Mean Imputation' or dropping assets. You minimize w'Cw subject to sum(w)=1.\n</reason>\n<exception>\nMean imputation destroys the correlation structure (biases towards zero/average). Better methods are 'Factor Models' (IPCA) or 'Shrinkage Estimators' (Ledoit-Wolf). You can estimate the missing correlations based on the asset's beta to common factors rather than pair-wise history.\n</exception>\n<tension>\nThis is a tension between 'Data Completeness' and 'Model Robustness'. Garbage in, garbage out.\n</tension>\n<categorization>\nThis is a 'Portfolio Construction' and 'Data Science' problem.\n</categorization>\n<deconstruction>\nDirect optimization on a 50x50 matrix is unstable (error maximization). Using a Factor Model (e.g., CAPM or Fama-French) reduces the parameters to estimate from N*(N-1)/2 to just N betas.\n</deconstruction>\n<conclusion>\nUse a 'Factor-Based Covariance Matrix' reconstruction. Do not use simple mean imputation. The factor structure preserves the systematic risk relationships even with missing pair-wise data.\n</conclusion>"
    },
    {
        "Question": "A portfolio has a Sharpe ratio of 1.2 with an annual volatility of 15%. If you increase leverage by 2x, what happens to the Sharpe ratio, and what are the hidden risks?",
        "Reasoning": "<reason>\nThe Sharpe Ratio is scale-invariant. If you 2x leverage, both Return (numerator) and Volatility (denominator) double. The ratio stays 1.2. Leverage does not change the risk-adjusted return.\n</reason>\n<exception>\nIn reality, Sharpe decreases. Borrowing costs (margin interest) reduce the net return. More importantly, leverage introduces 'Path Dependence' and 'Ruina Risk'. A 50% drawdown at 1x is painful; at 2x, it is a 100% wipeout (Margin Call). Volatility drag decays the compounded return.\n</exception>\n<tension>\nThis is a tension between 'Theoretical Arithmetic' (Linear) and 'Practical Solvency' (Non-linear/Thresholds).\n</tension>\n<categorization>\nThis is a 'Portfolio Theory' and 'Leverage' dilemma.\n</categorization>\n<deconstruction>\nThe hidden risk is 'Liquidity Risk'. Leveraged positions may be forced to sell at the bottom to meet margin, locking in losses. Unleveraged portfolios can ride it out.\n</deconstruction>\n<conclusion>\nThe Sharpe Ratio theoretically remains 1.2 (minus borrowing cost), but the 'Probability of Ruin' increases exponentially. Leverage magnifies the left tail.\n</conclusion>"
    },
    {
        "Question": "Describe the mechanics of a variance swap. How would you price it, and what are its advantages over standard volatility derivatives?",
        "Reasoning": "<reason>\nA variance swap pays the difference between 'Realized Variance' and a fixed 'Strike Variance' (squared volatility). It provides pure exposure to volatility without the path dependency of delta-hedging options. Pricing involves a static portfolio of OTM calls and puts.\n</reason>\n<exception>\nAdvantage: It is convex. Variance is Volatility squared. A spike in Volatility from 20 to 40 increases Variance from 400 to 1600 (4x). Standard options (Vega) are linear to Vol. Disadvantage: The payout can be enormous (short seller risk).\n</exception>\n<tension>\nThis is a tension between 'Pure Volatility Exposure' and 'Tail Risk Convexity'.\n</tension>\n<categorization>\nThis is a 'Exotic Derivatives' problem.\n</categorization>\n<deconstruction>\nPricing relies on the 'Log Contract'. You replicate the log payoff using a strip of options weighted by 1/K^2. This captures the skew perfectly.\n</deconstruction>\n<conclusion>\nUse Variance Swaps for pure, convex bets on market panic. Price them using the integral of option prices across strikes (VIX methodology). Be wary of the capped downside/unlimited upside profile if shorting.\n</conclusion>"
    },
    {
        "Question": "An investor holds a portfolio with a correlation matrix that exhibits time-varying correlations. How would you model this using Dynamic Conditional Correlation (DCC) models?",
        "Reasoning": "<reason>\nStandard GARCH models volatility, but DCC-GARCH models the *correlation* evolution. It assumes correlation is mean-reverting but shocks (news) cause temporary spikes. You estimate the univariate GARCH for each asset, then the correlation matrix dynamics.\n</reason>\n<exception>\nDCC assumes the same dynamics for all correlations (scalar parameters). In a 50-asset portfolio, this is restrictive. Also, estimating large DCC matrices is computationally unstable. It might overfit noise.\n</exception>\n<tension>\nThis is a tension between 'Model Sophistication' (Time-varying) and 'Estimation Error' (Stability).\n</tension>\n<categorization>\nThis is a 'Econometrics' and 'Risk Modeling' problem.\n</categorization>\n<deconstruction>\nCorrelations tend to go to 1.0 during crashes. A simpler approach might be 'Regime Switching' (Normal Matrix vs Panic Matrix) rather than a continuous DCC process.\n</deconstruction>\n<conclusion>\nUse DCC for small systems (FX pairs). For large portfolios, use Regime-Switching or Factor GARCH. Ensure the resulting matrices are always 'Positive Definite'.\n</conclusion>"
    },
    {
        "Question": "What is the difference between systematic and idiosyncratic risk? How would you decompose portfolio risk using factor models?",
        "Reasoning": "<reason>\nSystematic risk (Beta) is market-wide and undiversifiable (interest rates, GDP). Idiosyncratic risk (Alpha/Residual) is specific to the asset (CEO scandal). Factor models (like Barra) regress returns against common factors (Value, Momentum, Market). $R = B*F + e$.\n</reason>\n<exception>\nIn times of crisis, idiosyncratic risk can *become* systematic (Contagion). Also, 'Factors' are just statistical artifacts; they can change. A 'Low Vol' factor might become crowded and risky.\n</exception>\n<tension>\nThis is a tension between 'Diversification' (Free lunch) and 'Correlation Breakdown' (No lunch).\n</tension>\n<categorization>\nThis is a 'Risk Management' and 'APT' problem.\n</categorization>\n<deconstruction>\nRisk Decomposition: Total Variance = Systematic Variance ($B^2 * Var(F)$) + Idiosyncratic Variance ($Var(e)$). Diversification eliminates the second term, leaving only the first.\n</deconstruction>\n<conclusion>\nUse a multi-factor model (Fama-French or commercial). If Idiosyncratic risk is >10% of total risk in a diversified fund, you are likely not fully diversified or are taking active bets.\n</conclusion>"
    },
    {
        "Question": "A hedge fund's portfolio exhibits negative convexity. Explain this concept and its implications for portfolio rebalancing during market stress.",
        "Reasoning": "<reason>\nNegative convexity means price declines accelerate as yields rise (or market falls), and price gains decelerate as markets rise. Example: MBS or Short Options. You lose more in a down move than you make in an up move.\n</reason>\n<exception>\nimplication: 'Short Gamma'. As the market drops, your delta increases (you get longer), forcing you to sell to rebalance. This selling drives the market lower. It creates a feedback loop of 'Buy High, Sell Low'.\n</exception>\n<tension>\nThis is a tension between 'Yield Enhancement' (Selling convexity collects premium) and 'Tail Risk' (Explosive losses).\n</tension>\n<categorization>\nThis is a 'Fixed Income' and 'Derivatives' problem.\n</categorization>\n<deconstruction>\nMost yield-seeking strategies (High Yield, MBS, Vol Selling) are short convexity. It works 99% of the time (carry) and kills you 1% of the time.\n</deconstruction>\n<conclusion>\nNegative convexity requires 'Dynamic Hedging' or 'Liquidity Buffers'. You must be prepared to be a liquidity provider when everyone else is taking liquidity, or you will be forced to liquidate at the bottom.\n</conclusion>"
    },
    {
        "Question": "How would you calculate the marginal contribution to risk (MCR) for an individual position in a multi-asset portfolio?",
        "Reasoning": "<reason>\nMCR is the partial derivative of the Portfolio Volatility with respect to the asset weight. $MCR_i = (w * Cov * w)_i / Vol_p$. It measures how much adding $1 of asset i adds to the total risk.\n</reason>\n<exception>\nMCR changes dynamically. An asset might be a hedge (negative MCR) today but a risk adder (positive MCR) tomorrow if correlations flip. Calculating it requires a robust covariance matrix.\n</exception>\n<tension>\nThis is a tension between 'Asset Volatility' and 'Portfolio Correlation'. High vol assets can have low MCR if they are uncorrelated.\n</tension>\n<categorization>\nThis is a 'Portfolio Construction' problem.\n</categorization>\n<deconstruction>\nSum of (Weight * MCR) = Total Portfolio Volatility. This Euler decomposition allows for 'Risk Parity' weighting (equalizing contributions).\n</deconstruction>\n<conclusion>\nCalculate MCR to identify 'Risk Concentrations'. Often, a small weight in a high-beta asset contributes more risk than a large weight in bonds. Equalize MCRs to maximize diversification.\n</conclusion>"
    },
    {
        "Question": "Explain the concept of liquidity-adjusted VaR. How does illiquid asset concentration affect tail risk measurement?",
        "Reasoning": "<reason>\nStandard VaR assumes you can liquidate positions instantly at the market price. L-VaR adds the 'Liquidation Cost' (Bid-Ask spread + Market Impact) and the 'Time to Liquidate'. $L-VaR = VaR + Liquidity Cost$.\n</reason>\n<exception>\nIlliquidity is not linear. In a tail event, liquidity evaporates (gaps). The bid-ask spread might go from 1% to 50%. Standard L-VaR models based on average volume underestimate this 'Liquidity Black Hole'.\n</exception>\n<tension>\nThis is a tension between 'Mark-to-Market' (Theoretical price) and 'Mark-to-Liquidation' (Realizable price).\n</tension>\n<categorization>\nThis is a 'Risk Management' and 'Market Microstructure' problem.\n</categorization>\n<deconstruction>\nFor illiquid assets (PE, distressed debt), VaR is meaningless because volatility is smoothed. You need 'Time-to-Liquidation' limits. Concentration prevents exit.\n</deconstruction>\n<conclusion>\nAdjust VaR by assuming a holding period equal to the days required to liquidate 100% of the position at 10% of daily volume. If that period is > VaR horizon, the risk is understated.\n</conclusion>"
    },
    {
        "Question": "A portfolio manager notices that correlation across assets spikes during market downturns. What framework would you use to model this behavior?",
        "Reasoning": "<reason>\nThis is 'Correlation Breakdown' or 'Tail Dependence'. Use 'Copulas' (specifically Student-t Copula or Clayton Copula) which allow for higher dependence in the tails than the center. Gaussian Copulas (Normal) fail here.\n</reason>\n<exception>\nOr use 'Regime Switching Models'. Define a 'Calm' regime (low corr) and a 'Stress' regime (high corr). The model calculates the probability of being in the Stress regime and blends the matrices.\n</exception>\n<tension>\nThis is a tension between 'Linear Correlation' (Pearson) and 'Non-Linear Dependence' (Tail dependence).\n</tension>\n<categorization>\nThis is a 'Quantitative Finance' and 'Statistics' problem.\n</categorization>\n<deconstruction>\nDiversification works when you don't need it, and fails when you do. Modeling this prevents over-leveraging based on false diversification benefits.\n</deconstruction>\n<conclusion>\nUse Copulas to stress test the portfolio. Ensure the portfolio survives a scenario where all correlations go to 1.0 (Cash is the only uncorrelated asset in a crash).\n</conclusion>"
    },
    {
        "Question": "How would you construct a stress test for a portfolio with exposure to multiple asset classes, currencies, and derivatives?",
        "Reasoning": "<reason>\nIdentify key risk factors (Rates, Equity, Vol, FX). Define historical scenarios (2008, 2020) and hypothetical scenarios (Rates +200bps, Oil -50%). Revalue every position under these shocked factors.\n</reason>\n<exception>\nDerivatives have non-linear payoffs (Gamma/Convexity). You cannot just use Beta. You must 'Full Revaluation' (re-price the option using Black-Scholes with new inputs) rather than linear approximation (Delta-Gamma). Correlations also break.\n</exception>\n<tension>\nThis is a tension between 'Factor Sensitivity' (Linear) and 'Full Repricing' (Computationally expensive).\n</tension>\n<categorization>\nThis is a 'Risk Management' problem.\n</categorization>\n<deconstruction>\nStress tests should include 'Reverse Stress Testing': What scenario breaks the fund? Start from the loss and work backward to the market moves.\n</deconstruction>\n<conclusion>\nPerform Full Revaluation stress tests. Include 'Second Order' effects (e.g., if Equity falls, Volatility rises). Simple linear shocks underestimate derivative losses.\n</conclusion>"
    },
    {
        "Question": "What is the relationship between skewness, kurtosis, and tail risk? How would you adjust your risk models to account for non-normal return distributions?",
        "Reasoning": "<reason>\nSkewness measures asymmetry (Left skew = crash risk). Kurtosis measures 'Fat Tails' (extreme events). Standard Normal has Skew=0, Kurtosis=3. Markets have negative skew and high kurtosis (Leptokurtic).\n</reason>\n<exception>\nStandard Mean-Variance Optimization assumes Normality. It buys negative skew assets (selling puts) because they look like high Sharpe/low vol, until they blow up. You must use 'Cornish-Fisher Expansion' or 'Extreme Value Theory' (EVT) to adjust VaR.\n</exception>\n<tension>\nThis is a tension between 'Gaussian Convenience' and 'Empirical Reality'.\n</tension>\n<categorization>\nThis is a 'Statistics' and 'Risk' problem.\n</categorization>\n<deconstruction>\nPreference for skewness: Investors like lottery tickets (positive skew) and dislike crashes (negative skew). Assets with negative skew (Carry trades) should yield a premium.\n</deconstruction>\n<conclusion>\nReplace Standard VaR with Modified VaR (using Cornish-Fisher) or EVT VaR. Penalize assets with negative skew and high kurtosis in the optimization function.\n</conclusion>"
    },
    {
        "Question": "A fund has a Sortino ratio of 1.8 compared to a Sharpe ratio of 1.2. What does this tell you about the fund's return distribution and risk profile?",
        "Reasoning": "<reason>\nSharpe penalizes *all* volatility (upside and downside). Sortino penalizes only *downside* volatility (deviation below target). A Sortino > Sharpe implies the fund's volatility is mostly 'good' (upside). The distribution is positively skewed.\n</reason>\n<exception>\nIt suggests the fund might be a 'Trend Follower' or long 'Convexity' (Calls). It avoids large drawdowns. However, check the target return used for Sortino. If the target is too low, Sortino is inflated.\n</exception>\n<tension>\nThis is a tension between 'Variance' (Noise) and 'Semivariance' (Loss).\n</tension>\n<categorization>\nThis is a 'Performance Analysis' problem.\n</categorization>\n<deconstruction>\nA high Sortino is desirable. It means the fund is efficient at generating returns without crashing. Sharpe treats a +10% month as 'risk'; Sortino ignores it.\n</deconstruction>\n<conclusion>\nThe fund has a favorable risk profile with limited downside deviation. It likely employs stop-losses or long-option strategies. It is superior to a fund with Sharpe 1.2 / Sortino 0.8 (which would imply negative skew).\n</conclusion>"
    },
    {
        "Question": "Derive the Black-Scholes pricing formula from first principles using risk-neutral valuation. What are the key assumptions, and how would you modify them for American options?",
        "Reasoning": "<reason>\nBS assumes Geometric Brownian Motion (GBM), continuous trading, constant vol/rates, no dividends, no arb. Price = Expected Payoff discounted at risk-free rate under the Risk-Neutral Measure (Q). $C = S N(d1) - K e^{-rt} N(d2)$.\n</reason>\n<exception>\nAmerican options can be exercised early. BS doesn't handle this (mostly). Early exercise is optimal for Puts (deep ITM) or Calls with Dividends. You need 'Binomial Trees' or 'Finite Difference Methods' to solve the PDE with a free boundary condition.\n</exception>\n<tension>\nThis is a tension between 'Closed-Form Elegance' (BS) and 'Numerical Reality' (American/Dividends).\n</tension>\n<categorization>\nThis is a 'Derivatives Pricing' problem.\n</categorization>\n<deconstruction>\nThe key assumption failure is 'Constant Volatility'. Real markets have smiles/skews. Also 'Continuous Trading' fails (gaps). BS is a model, not a law.\n</deconstruction>\n<conclusion>\nUse BS for European options as a baseline. Use Binomial/Trinomial trees for American options. Adjust implied volatility input to account for the model's structural flaws (Smile).\n</conclusion>"
    },
    {
        "Question": "A trader enters a straddle position (long call and put at the same strike). What market conditions would profit this position, and how would you hedge gamma risk?",
        "Reasoning": "<reason>\nA long straddle profits from High Volatility. You need the stock to move significantly in *either* direction (beyond the premiums paid). It is a long Vega / long Gamma trade.\n</reason>\n<exception>\nIt suffers from Theta decay (time value erosion). If the market is flat, you bleed cash daily. Hedging Gamma: As the stock moves, your Delta changes. You must scalp stock (buy low, sell high) to stay Delta Neutral. This scalping offsets the Theta loss.\n</exception>\n<tension>\nThis is a tension between 'Realized Volatility' (Movement) and 'Implied Volatility' (Cost).\n</tension>\n<categorization>\nThis is a 'Trading Strategy' problem.\n</categorization>\n<deconstruction>\nIf you Gamma hedge continuously, your P&L = 0.5 * Gamma * (Realized Vol^2 - Implied Vol^2). You profit if Realized > Implied. You are trading the spread between the two volatilities.\n</deconstruction>\n<conclusion>\nBuy straddles when IV is low and you expect a breakout. Hedge Gamma by rebalancing Delta periodically to lock in scalping gains, transforming the move into cash.\n</conclusion>"
    },
    {
        "Question": "Explain the concept of implied volatility smile/skew. What causes this phenomenon, and how would you trade it?",
        "Reasoning": "<reason>\nBS assumes constant vol. In reality, OTM Puts trade at higher IV than ATM (Skew) due to crash fear (Put protection demand). OTM Calls might trade higher or lower. The curve looks like a smile or smirk.\n</reason>\n<exception>\nCauses: Crashophobia (post-1987), Leverage effect (stock down = vol up), and Supply/Demand imbalance. To trade: Risk Reversal (Buy OTM Put, Sell OTM Call) to bet on skew steeping. Butterfly spread to bet on smile flattening.\n</exception>\n<tension>\nThis is a tension between 'Lognormal Assumption' and 'Fat Tail Reality'.\n</tension>\n<categorization>\nThis is a 'Volatility Surface' problem.\n</categorization>\n<deconstruction>\nThe Skew represents the market's price for 'Tail Risk'. It is expensive insurance. Selling the skew (Selling Puts) is a high-win-rate, high-blow-up-risk strategy.\n</deconstruction>\n<conclusion>\nThe Smile proves the market knows BS is wrong. Trade the Skew if you think the market is overestimating tail risk (Sell Skew) or underestimating it (Buy Skew).\n</conclusion>"
    },
    {
        "Question": "How would you price a barrier option using Monte Carlo simulation? What variance reduction techniques would you apply?",
        "Reasoning": "<reason>\nSimulate thousands of price paths (GBM). Check if the path hits the barrier. If Knocked Out -> Payoff 0. If Active -> Payoff Max(S-K, 0). Discount average payoff.\n</reason>\n<exception>\nStandard MC is slow and noisy. The barrier is sensitive to discrete time steps (Brownian Bridge needed to check probability of hitting *between* steps). Variance Reduction: Antithetic Variates (Simulate +Z and -Z), Control Variates (Use vanilla option price as anchor), or Importance Sampling.\n</exception>\n<tension>\nThis is a tension between 'Simulation Accuracy' and 'Computational Cost'.\n</tension>\n<categorization>\nThis is a 'Numerical Methods' problem.\n</categorization>\n<deconstruction>\nMonte Carlo is the 'Method of Last Resort'. If a PDE or Analytical approximation exists, use that. MC is best for path-dependent exotics.\n</deconstruction>\n<conclusion>\nUse MC with 'Brownian Bridge' adjustment for the barrier crossing. Apply Antithetic Variates to halve the error. Ensure convergence ($1/\\sqrt{N}$).\n</conclusion>"
    },
    {
        "Question": "A fund holds a large position in convertible bonds. How would you decompose the valuation into equity, bond, and option components?",
        "Reasoning": "<reason>\nA Convertible Bond = Straight Bond + Long Call Option (on stock). Value = Value(Bond Floor) + Value(Option). The Bond Floor acts as downside protection; Option gives upside participation.\n</reason>\n<exception>\nComplexity: Credit risk of the issuer affects the Bond Floor. Volatility affects the Option. Correlation between Stock and Credit Spread is key (as stock falls, spread widens, hurting the bond floor). This is the 'Death Spiral'.\n</exception>\n<tension>\nThis is a tension between 'Fixed Income' (Rates/Credit) and 'Equity Derivatives' (Vol/Delta).\n</tension>\n<categorization>\nThis is a 'Convertible Arbitrage' problem.\n</categorization>\n<deconstruction>\nConvertible Arbitrage: Buy Bond, Short Stock (hedging Delta). You capture the yield and the cheap volatility (gamma). You profit if the stock is volatile but doesn't default.\n</deconstruction>\n<conclusion>\nDecompose into spread risk (Bond) and Vol risk (Option). Hedge the delta. Watch the 'Gamma' of the bond (how convexity changes) and the credit spread duration.\n</conclusion>"
    },
    {
        "Question": "What is the relationship between vega and realized volatility? How would you construct a volatility arbitrage strategy?",
        "Reasoning": "<reason>\nVega measures sensitivity to *Implied* Volatility changes. Realized Volatility is the actual movement. Vol Arb bets that Implied != Future Realized. If IV > Forecasted RV, Sell Straddle (Short Vega). Delta hedge to isolate the Vol bet.\n</reason>\n<exception>\nVega is highest ATM and with longer maturity. Realized Vol is path-dependent. Strategy: Delta-Neutral Portfolio. Profit = Vega * (Change in IV) + 0.5 * Gamma * (Realized^2 - Implied^2).\n</exception>\n<tension>\nThis is a tension between 'Market Pricing' (IV) and 'Statistical Expectation' (RV).\n</tension>\n<categorization>\nThis is a 'Volatility Trading' problem.\n</categorization>\n<deconstruction>\nYou are trading the 'Variance Risk Premium'. Historically, IV > RV (insurance premium). Selling Vol collects this premium but risks tail events.\n</deconstruction>\n<conclusion>\nBuy options when IV is cheap relative to your RV forecast. Sell when expensive. Hedge Delta scrupulously to remove directional risk. The edge is in the forecast.\n</conclusion>"
    },
    {
        "Question": "Explain the mechanics of a swaption. How does the Black model differ from Black-Scholes for interest rate derivatives?",
        "Reasoning": "<reason>\nA Swaption is an option to enter into an Interest Rate Swap (Payer = Pay Fixed, Receiver = Receive Fixed). Black-76 model is used, assuming the *Forward Rate* is lognormal (not the price). Inputs: Forward Swap Rate, Volatility of the Rate.\n</reason>\n<exception>\nInterest rates can be negative (Normal model needed vs Lognormal). Also, rates have a term structure. Black model assumes a single forward rate. It ignores the 'Smile' in interest rates (SABR model is better).\n</exception>\n<tension>\nThis is a tension between 'Equity Models' (Stock Price) and 'Rate Models' (Mean reverting, term structure).\n</tension>\n<categorization>\nThis is a 'Fixed Income Derivatives' problem.\n</categorization>\n<deconstruction>\nSwaptions allow hedging future issuance or callable bonds. Payer Swaption protects against rising rates. Receiver protects against falling rates.\n</deconstruction>\n<conclusion>\nUse Black-76 for standard pricing, but switch to SABR or Normal (\"Bachelier\") model if rates are near zero/negative or for accurate smile pricing.\n</conclusion>"
    },
    {
        "Question": "A portfolio manager wants to reduce duration risk without selling bonds. What derivative strategies would you recommend, and what are the trade-offs?",
        "Reasoning": "<reason>\nSell Treasury Futures (e.g., 10Y Note futures) or Pay Fixed on an Interest Rate Swap (IRS). This creates negative duration to offset the bond portfolio. \n</reason>\n<exception>\nTrade-offs: Futures have 'Basis Risk' (Cheapest to Deliver bond might not match your portfolio). Swaps have 'Counterparty Risk' and liquidity constraints. Buying Puts on Bonds is another option (Convex hedge) but costs premium.\n</exception>\n<tension>\nThis is a tension between 'Perfect Hedge' (Selling the asset) and 'Overlay Hedge' (Basis/Cost).\n</tension>\n<categorization>\nThis is a 'Hedging' problem.\n</categorization>\n<deconstruction>\nDuration hedging works for parallel shifts. If the curve twists (flattening/steepening), a single future (10Y) might fail to hedge a barbell portfolio. Key Rate Duration hedging is required.\n</deconstruction>\n<conclusion>\nUse Futures for tactical, short-term hedges (liquid, cheap). Use Swaps for precise, long-term liability matching. Monitor the basis.\n</conclusion>"
    },
    {
        "Question": "How would you price a credit default swap (CDS)? What factors drive CDS spreads, and how would you identify mispricings?",
        "Reasoning": "<reason>\nCDS Price (Spread) approx = Probability of Default (PD) * Loss Given Default (LGD). Theoretically, CDS Spread = Bond Yield - Risk Free Rate (Asset Swap Spread). Discount the expected premium legs vs expected default leg.\n</reason>\n<exception>\nFactors: Liquidity, Counterparty risk, and 'Cheapest to Deliver' option in the auction. Mispricing: If CDS Spread >> Bond Z-Spread, sell protection and buy bond (Negative Basis trade). If CDS << Spread, buy protection.\n</exception>\n<tension>\nThis is a tension between 'Credit Fundamental' (PD) and 'Market Technicals' (Liquidity/Flows).\n</tension>\n<categorization>\nThis is a 'Credit Derivatives' problem.\n</categorization>\n<deconstruction>\nCDS is often more liquid than the bond. It reacts faster to news. The 'Basis' is the arb. A non-zero basis persists due to funding costs (haircuts).\n</deconstruction>\n<conclusion>\nPrice using the 'Hazard Rate' model. Trade the Basis. Remember that CDS is a synthetic instrument; intrinsic value is driven by the legal definition of 'Credit Event'.\n</conclusion>"
    },
    {
        "Question": "Describe the concept of gamma decay. How would you dynamically hedge a short gamma position?",
        "Reasoning": "<reason>\nShort Gamma (Short Straddle) means your delta moves *against* you. As market rises, you get shorter (need to buy to cover). As market falls, you get longer (need to sell). You are 'selling low, buying high'. This realized loss is the cost of the position, hopefully offset by Theta (time decay).\n</reason>\n<exception>\nHedging: You must re-hedge delta back to zero periodically. If you hedge too often, you lock in small losses (whipsaw). If too rarely, you risk a huge move. Optimization of hedging frequency is key.\n</exception>\n<tension>\nThis is a tension between 'Transaction Costs' (Hedging often) and 'Gap Risk' (Hedging rarely).\n</tension>\n<categorization>\nThis is a 'Dynamic Hedging' problem.\n</categorization>\n<deconstruction>\nGamma is highest ATM and near expiration. 'Pin Risk'. The decay accelerates. Short Gamma is picking up pennies in front of a steamroller.\n</deconstruction>\n<conclusion>\nHedge based on 'Delta Bands' (e.g., rehedge when delta hits +/- 0.10). Don't hedge on time; hedge on price movement. Close the position before expiration to avoid the Gamma explosion.\n</conclusion>"
    },
    {
        "Question": "What is a quanto derivative? How would you price a quanto call option on a foreign equity index?",
        "Reasoning": "<reason>\nA Quanto (Quantity Adjusting) option pays off in domestic currency but based on a foreign asset's return, with a fixed exchange rate. Example: S&P 500 Call denominated in EUR with fixed FX rate.\n</reason>\n<exception>\nPricing: Requires adjusting the drift of the asset. The correlation between the Asset Price and the FX Rate is crucial. If correlated, a 'Quanto Adjustment' term is added to the drift (Dividend yield shift). $\\rho_{S,FX} \\sigma_S \\sigma_{FX}$.\n</exception>\n<tension>\nThis is a tension between 'Asset Performance' and 'Currency Exposure'. Quanto removes the FX risk for the buyer.\n</tension>\n<categorization>\nThis is a 'Exotic Option' problem.\n</categorization>\n<deconstruction>\nQuantos allow investors to access foreign beta without currency beta. The hedging involves holding the foreign stock and trading the FX forward to neutralize the currency exposure dynamically.\n</deconstruction>\n<conclusion>\nPrice using Black-Scholes with the 'Quanto Drift Adjustment'. The correlation parameter is the biggest model risk. If correlation shifts, the hedge fails.\n</conclusion>"
    },
    {
        "Question": "Explain the mechanics of a TRS (Total Return Swap). What are its use cases in hedge fund and PE strategies?",
        "Reasoning": "<reason>\nTRS: One party pays the Total Return of an asset (Capital Gains + Dividends) and receives a floating rate (Libor/SOFR) + Spread. It is synthetic ownership. The Payer shorts the asset; the Receiver goes long.\n</reason>\n<exception>\nUse Cases: Leverage (Receiver gets exposure without funding the full purchase), Access (buying restricted market assets), and Tax/Anonymity (keeping off the shareholder register). PE uses it to build stakes quietly.\n</exception>\n<tension>\nThis is a tension between 'Physical Ownership' and 'Synthetic Exposure'.\n</tension>\n<categorization>\nThis is a 'Prime Brokerage' and 'Derivatives' problem.\n</categorization>\n<deconstruction>\nThe risk is 'Counterparty Risk'. If the bank fails (Lehman), the hedge fund loses its collateral. Also, voting rights usually stay with the bank, not the TRS holder.\n</deconstruction>\n<conclusion>\nUse TRS for leverage and balance sheet efficiency. Be aware of the financing spread and the collateral haircuts. It is the primary tool for 'Equity Swaps'.\n</conclusion>"
    },
    {
        "Question": "How would you price an American option using binomial trees versus finite difference methods? What are the computational trade-offs?",
        "Reasoning": "<reason>\nBinomial Tree: Discrete time/price steps (Up/Down). easy to implement, intuitive. Backward induction allows checking for early exercise at nodes. $O(N^2)$.\nFinite Difference (FDM): Solves the Black-Scholes PDE on a grid. Implicit or Crank-Nicolson methods. More accurate for greeks.\n</reason>\n<exception>\nTrade-off: Trees oscillate convergence (odd/even steps). FDM is smoother and handles barriers/discrete dividends better. FDM is harder to code (matrix inversion). Trees struggle with multiple factors (dimensionality curse).\n</exception>\n<tension>\nThis is a tension between 'Simplicity/Speed' (Trees) and 'Accuracy/Stability' (FDM).\n</tension>\n<categorization>\nThis is a 'Numerical Analysis' problem.\n</categorization>\n<deconstruction>\nFor 1D American options, Binomial is fine. For high precision or complex boundaries, FDM is better. For path-dependence, use Monte Carlo (Least Squares MC for American).\n</deconstruction>\n<conclusion>\nUse Binomial (Cox-Ross-Rubinstein) for quick checks. Use Crank-Nicolson FDM for production pricing engines requiring stable Greeks.\n</conclusion>"
    },
    {
        "Question": "A trader has a short volatility position (short straddle). How would you calculate the breakeven points and manage the position during volatile markets?",
        "Reasoning": "<reason>\nBreakeven = Strike +/- Total Premium Received. Profit if stock stays within range. Management: If stock touches breakeven, roll the position (close and open new ATM) or hedge delta to flatten the risk.\n</reason>\n<exception>\nRolling locks in a loss. Ideally, you hedge with OTM 'Wings' (Iron Condor) to cap the downside. Stop-loss based on '2x Premium' rule. Don't let a defined risk trade become undefined.\n</exception>\n<tension>\nThis is a tension between 'Collecting Premium' and 'Defending the Strike'.\n</tension>\n<categorization>\nThis is a 'Vol Trading' problem.\n</categorization>\n<deconstruction>\nShort straddles have 'Negative Gamma'. The loss accelerates. In volatile markets, the 'implied' touch probability is higher. Managing solely by delta hedging is expensive (whipsaw).\n</deconstruction>\n<conclusion>\nKnow your exit before entering. If IV expands, mark-to-market loss hurts even if price is stable. Close or roll when the thesis (low vol) is invalidated, not just when price moves.\n</conclusion>"
    },
    {
        "Question": "What is the relationship between realized volatility and implied volatility? How would you construct a volatility forecasting model?",
        "Reasoning": "<reason>\nIV is the market's forecast. RV is the actual outcome. IV usually > RV (Variance Risk Premium). Forecasting: Use GARCH (Generalized Autoregressive Conditional Heteroskedasticity) or EWMA (Exponentially Weighted Moving Average). Past vol predicts future vol (clustering).\n</reason>\n<exception>\nIV contains the 'Fear Premium'. Forecasting models must account for 'Mean Reversion' (Vol goes back to average) and 'Leverage Effect' (Vol increases when price drops). High Frequency data (Intraday RV) improves forecasts.\n</exception>\n<tension>\nThis is a tension between 'Time Series History' and 'Market Expectation' (Option Prices).\n</tension>\n<categorization>\nThis is a 'Econometrics' problem.\n</categorization>\n<deconstruction>\nThe best forecast combines both: HAR-RV model (Heterogeneous Autoregressive) using daily, weekly, monthly RV + Implied Vol input.\n</deconstruction>\n<conclusion>\nVol is predictable (unlike returns). Construct a GARCH or HAR model. Trade the delta between your forecast and the market's IV. If IV is in the 99th percentile, revert to mean is likely.\n</conclusion>"
    }
]

filename = 'tetralemma-reasoning-train.csv'
with open(filename, 'a', newline='', encoding='utf-8') as f:
    writer = csv.DictWriter(f, fieldnames=['Question', 'Reasoning'])
    for entry in new_entries:
        writer.writerow(entry)

print(f"Appended {len(new_entries)} entries (Batch 5) to {filename}")
